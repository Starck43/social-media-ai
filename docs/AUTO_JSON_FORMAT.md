# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ JSON —Ñ–æ—Ä–º–∞—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç—ã

**–î–∞—Ç–∞**: 16.10.2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–í–µ—Ä—Å–∏—è**: v3.0-auto-json

---

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –≤—Å–µ–≥–¥–∞ –¥–æ–ø–∏—Å—ã–≤–∞—Ç—å:

```
–í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å –ø–æ–ª—è–º–∏: main_topics, overall_mood, highlights
```

–≠—Ç–æ –±—ã–ª–æ:
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–æ (–ø–æ–≤—Ç–æ—Ä—è–ª–æ—Å—å –≤ –∫–∞–∂–¥–æ–º –ø—Ä–æ–º–ø—Ç–µ)
- ‚ùå –ü–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –æ—à–∏–±–∫–∞–º (–º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å)
- ‚ùå –ù–µ—É–¥–æ–±–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Å—Ç—Ñ–∏–∫—Å —Å JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –¥–ª—è –≤—Å–µ—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è**: –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ—Å—Ç—å –ª–∏ –≤ –ø—Ä–æ–º–ø—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ `json`, `—Ñ–æ—Ä–º–∞—Ç–µ json`, `–≤–µ—Ä–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ`
2. **–ê–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ**: –ï—Å–ª–∏ JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–µ—Ç - –æ–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**: –î–ª—è text/image/video —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã JSON

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –§–∞–π–ª: `app/services/ai/prompts.py`

```python
@staticmethod
def _ensure_json_instruction(prompt: str, media_type: MediaType) -> str:
    """
    Ensure prompt has JSON format instruction appended if not present.
    """
    from app.utils.enum_helpers import get_enum_value
    
    # Check if prompt already mentions JSON format
    prompt_lower = prompt.lower()
    if any(keyword in prompt_lower for keyword in ['json', '—Ñ–æ—Ä–º–∞—Ç–µ json', '–≤–µ—Ä–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ']):
        # Already has JSON instruction
        return prompt
    
    # Append JSON instruction based on media type
    media_value = get_enum_value(media_type)
    
    if media_value == 'text':
        json_instruction = """

–í–ê–ñ–ù–û: –í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å –ø–æ–ª—è–º–∏:
{
    "main_topics": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2", "—Ç–µ–º–∞3"],
    "overall_mood": "–æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—â–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ—è",
    "highlights": ["–≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –º–æ–º–µ–Ω—Ç1", "–≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –º–æ–º–µ–Ω—Ç2"],
    "sentiment_score": 0.0-1.0
}
"""
    elif media_value == 'image':
        json_instruction = """

–í–ê–ñ–ù–û: –í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å –ø–æ–ª—è–º–∏:
{
    "visual_themes": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2", "—Ç–µ–º–∞3"],
    "dominant_colors": ["—Ü–≤–µ—Ç1", "—Ü–≤–µ—Ç2"],
    "mood": "–æ–ø–∏—Å–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è"
}
"""
    elif media_value == 'video':
        json_instruction = """

–í–ê–ñ–ù–û: –í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å –ø–æ–ª—è–º–∏:
{
    "video_types": ["—Ç–∏–ø1", "—Ç–∏–ø2"],
    "main_themes": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2"],
    "content_style": "–æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∏–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"
}
"""
    else:
        # Generic JSON instruction
        json_instruction = """

–í–ê–ñ–ù–û: –í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ.
"""
    
    return prompt + json_instruction
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ PromptBuilder:

```python
@staticmethod
def get_prompt(media_type: MediaType, scenario: Optional['BotScenario'] = None, **context) -> str:
    # ... existing code ...
    
    # Use custom prompt if available
    if custom_prompt:
        # Prepare variables based on media type
        variables = PromptBuilder._prepare_variables(media_type, **context)
        prompt = PromptSubstitution.substitute(custom_prompt, variables)
        
        # üÜï Auto-append JSON instruction if not present
        prompt = PromptBuilder._ensure_json_instruction(prompt, media_type)
        return prompt
    
    # Fallback to default prompts (already have JSON instructions)
    return PromptBuilder._get_default_prompt(media_type, **context)
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ (–Ω—É–∂–Ω–æ –±—ã–ª–æ –ø–∏—Å–∞—Ç—å):

```
–°–¥–µ–ª–∞–π –±—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ {platform}.

–ö—Ä–∞—Ç–∫–æ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è):
1. –û —á—ë–º –≥–æ–≤–æ—Ä—è—Ç (–≥–ª–∞–≤–Ω—ã–µ —Ç–µ–º—ã)
2. –ß—Ç–æ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è (–Ω–µ–æ–±—ã—á–Ω–æ–µ –∏–ª–∏ –≤–∞–∂–Ω–æ–µ)

–í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å –ø–æ–ª—è–º–∏: main_topics, overall_mood, highlights
```

### –ü–æ—Å–ª–µ (–ø–∏—à–µ–º —Ç–æ–ª—å–∫–æ —Å—É—Ç—å):

```
–°–¥–µ–ª–∞–π –±—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ {platform}.

–ö—Ä–∞—Ç–∫–æ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è):
1. –û —á—ë–º –≥–æ–≤–æ—Ä—è—Ç (–≥–ª–∞–≤–Ω—ã–µ —Ç–µ–º—ã)
2. –ß—Ç–æ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è (–Ω–µ–æ–±—ã—á–Ω–æ–µ –∏–ª–∏ –≤–∞–∂–Ω–æ–µ)
```

**–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç**:

```
–í–ê–ñ–ù–û: –í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ —Å –ø–æ–ª—è–º–∏:
{
    "main_topics": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2", "—Ç–µ–º–∞3"],
    "overall_mood": "–æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—â–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ—è",
    "highlights": ["–≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –º–æ–º–µ–Ω—Ç1", "–≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –º–æ–º–µ–Ω—Ç2"],
    "sentiment_score": 0.0-1.0
}
```

---

## JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ —Ç–∏–ø–∞–º –º–µ–¥–∏–∞

### TEXT (—Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç):

```json
{
    "main_topics": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2", "—Ç–µ–º–∞3"],
    "overall_mood": "–æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—â–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ—è",
    "highlights": ["–≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –º–æ–º–µ–Ω—Ç1", "–≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –º–æ–º–µ–Ω—Ç2"],
    "sentiment_score": 0.0-1.0
}
```

### IMAGE (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è):

```json
{
    "visual_themes": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2", "—Ç–µ–º–∞3"],
    "dominant_colors": ["—Ü–≤–µ—Ç1", "—Ü–≤–µ—Ç2"],
    "mood": "–æ–ø–∏—Å–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è"
}
```

### VIDEO (–≤–∏–¥–µ–æ):

```json
{
    "video_types": ["—Ç–∏–ø1", "—Ç–∏–ø2"],
    "main_themes": ["—Ç–µ–º–∞1", "—Ç–µ–º–∞2"],
    "content_style": "–æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∏–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"
}
```

---

## –ö–æ–≥–¥–∞ JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ù–ï –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è

–°–∏—Å—Ç–µ–º–∞ –ù–ï –¥–æ–±–∞–≤–∏—Ç JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –µ—Å–ª–∏ –≤ –ø—Ä–æ–º–ø—Ç–µ —É–∂–µ –µ—Å—Ç—å:

- ‚úÖ `json` (–ª—é–±–æ–π —Ä–µ–≥–∏—Å—Ç—Ä)
- ‚úÖ `—Ñ–æ—Ä–º–∞—Ç–µ json`
- ‚úÖ `–≤–µ—Ä–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ`
- ‚úÖ `JSON`
- ‚úÖ `JSON —Ñ–æ—Ä–º–∞—Ç–µ`

–ü—Ä–∏–º–µ—Ä—ã:

```
"–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∏ –≤–µ—Ä–Ω–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ"  ‚Üí –ù–ï –¥–æ–±–∞–≤–∏—Ç—Å—è (—É–∂–µ –µ—Å—Ç—å)
"–û—Ç–≤–µ—Ç—å –ø—Ä–æ—Å—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º"                ‚Üí –î–û–ë–ê–í–ò–¢–°–Ø
"–°–¥–µ–ª–∞–π –±—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑"                 ‚Üí –î–û–ë–ê–í–ò–¢–°–Ø
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- –ö–æ—Ä–æ—á–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ –ø—Ä–æ–º–ø—Ç—ã
- –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ (–∑–∞–±—ã–ª–∏ —É–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç)
- –õ–µ–≥—á–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### ‚úÖ –î–ª—è —Å–∏—Å—Ç–µ–º—ã:
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- –õ–µ–≥—á–µ –ø–∞—Ä—Å–∏—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –ú–µ–Ω—å—à–µ –∫–æ–ø–∏–ø–∞—Å—Ç—ã
- –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ)
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–æ–≤

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:

1. –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π
2. –í –ø–æ–ª–µ "Text Prompt" –Ω–∞–ø–∏—à–∏—Ç–µ —Ç–æ–ª—å–∫–æ:
   ```
   –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ {platform} –∏ —Å–∫–∞–∂–∏ –æ —á–µ–º –≥–æ–≤–æ—Ä—è—Ç
   ```
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∞–ª–∏–∑
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ AIAnalytics.prompt_text —á—Ç–æ JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–æ–±–∞–≤–∏–ª–∞—Å—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–¥–µ:

```python
from app.services.ai.prompts import PromptBuilder
from app.types import MediaType

# Test prompt without JSON
custom_prompt = "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ–Ω—Ç–µ–Ω—Ç"

# Get final prompt
final_prompt = PromptBuilder._ensure_json_instruction(custom_prompt, MediaType.TEXT)

print(final_prompt)
# –î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å "–í–ê–ñ–ù–û: –í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ..."
```

---

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å:
- –ö–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ –∏–∑ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –í—Å–µ–º–∏ —Ç–∏–ø–∞–º–∏ –º–µ–¥–∏–∞ (TEXT, IMAGE, VIDEO, AUDIO)
- –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö {platform}, {text}, etc.
- –°—Ç–∞—Ä—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ (—Å —è–≤–Ω–æ–π JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π)

### ‚ùå –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç:
- –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã (—É–∂–µ –∏–º–µ—é—Ç JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
- Unified summary –ø—Ä–æ–º–ø—Ç—ã
- –ü—Ä–æ–º–ø—Ç—ã —Å —è–≤–Ω–æ–π JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π

---

## FAQ

### Q: –ß—Ç–æ –µ—Å–ª–∏ —è —Ö–æ—á—É —Å–≤–æ–π —Ñ–æ—Ä–º–∞—Ç JSON?

**A**: –ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ—é JSON –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ –ø—Ä–æ–º–ø—Ç–µ. –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —á—Ç–æ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å JSON –∏ –Ω–µ –¥–æ–±–∞–≤–∏—Ç —Å–≤–æ—é.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ?

**A**: –î–∞, –ø—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∏—Ç–µ —Å–ª–æ–≤–æ "json" –≤ –ø—Ä–æ–º–ø—Ç. –°–∏—Å—Ç–µ–º–∞ —Ä–µ—à–∏—Ç —á—Ç–æ –≤—ã —É–∂–µ —É–∫–∞–∑–∞–ª–∏ —Ñ–æ—Ä–º–∞—Ç.

### Q: –ß—Ç–æ –µ—Å–ª–∏ LLM –Ω–µ –≤–µ—Ä–Ω–µ—Ç JSON?

**A**: –≠—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ LLM, –∞ –Ω–µ –ø—Ä–æ–º–ø—Ç–∞. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–¥–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSON mode –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª–∏ —Å –ª—É—á—à–µ–π instruction-following —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é.

### Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å unified summary?

**A**: –ü–æ–∫–∞ –Ω–µ—Ç. Unified summary –∏–º–µ–µ—Ç —Å–≤–æ—é –ª–æ–≥–∏–∫—É. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.

---

## Roadmap

### –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ:

- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–ª—è unified_summary_prompt
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AUDIO –º–µ–¥–∏–∞ —Ç–∏–ø–∞
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ JSON —Å—Ö–µ–º—ã —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ LLM –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ
- [ ] Retry —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º –µ—Å–ª–∏ JSON –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π

---

## Changelog

### v3.0-auto-json (16.10.2025)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_ensure_json_instruction()`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `PromptBuilder.get_prompt()`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TEXT, IMAGE, VIDEO
- ‚úÖ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è JSON –≤ –ø—Ä–æ–º–ø—Ç–µ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã

---

**–ê–≤—Ç–æ—Ä**: Factory Droid  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 16.10.2025  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 16.10.2025
