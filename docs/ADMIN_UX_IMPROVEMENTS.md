# Улучшения UX админ-панели для сценариев

**Дата**: 16.10.2025  
**Статус**: ✅ Реализовано  
**Версия**: v3.0-admin-ux

---

## Что улучшено

### ✅ 1. Добавлены подробные help_text с описанием переменных
### ✅ 2. Добавлены placeholder с примерами для всех промпт-полей
### ✅ 3. Улучшена документация всех полей сценария

---

## Детальное описание изменений

### 📝 Поле: **name** (Название)

**Help text**:
```
Название сценария. Краткое и понятное имя (например: "Экспресс-анализ", "Мониторинг бренда")
```

---

### 📝 Поле: **description** (Описание)

**Help text**:
```
Описание сценария. Для чего используется, какие задачи решает
```

---

### 📝 Поле: **content_types** (Типы контента)

**Help text**:
```html
Типы контента для сбора.

Выберите какой контент собирать:
• posts - основные посты/публикации
• comments - комментарии к постам
• mentions - упоминания источника
• stories - временные истории (если поддерживается)
• reactions - реакции/лайки
```

---

### 📝 Поле: **analysis_types** (Типы анализа)

**Help text**:
```html
Типы анализа контента.

Что анализировать:
• sentiment - тональность (позитив/негатив/нейтрально)
• topics - главные темы и категории
• keywords - ключевые слова и фразы
• engagement - вовлеченность аудитории
• brand_mentions - упоминания брендов
• trends - тренды и паттерны
```

---

### 📝 Поле: **scope** (Дополнительные параметры)

**Help text**:
```html
Дополнительные параметры в JSON формате.

Примеры:
• {"max_posts": 100} - ограничить количество постов
• {"keywords": ["продукт", "бренд"]} - фильтр по ключевым словам
• {"min_reactions": 10} - только посты с >10 реакциями
• {"sentiment_threshold": 0.7} - порог для определения тональности
```

---

### 📝 Поле: **collection_interval_hours** (Интервал сбора)

**Help text**:
```
Интервал сбора данных в часах. Как часто запускать сбор контента (например: 6, 12, 24)
```

---

### 📝 Поле: **text_prompt** (Промпт для текста)

**Help text**:
```html
Кастомный промпт для анализа текста. Оставьте пустым для дефолтного.

Доступные переменные:
• {text} - собранный текстовый контент (посты, комментарии)
• {platform} - название платформы (ВКонтакте, Telegram, и т.д.)
• {source_type} - тип источника (user, group, channel)
• {total_posts} - количество постов
• {avg_reactions} - среднее количество реакций
• {avg_comments} - среднее количество комментариев
• {date_from} - начало периода анализа
• {date_to} - конец периода анализа

💡 JSON формат добавляется автоматически! Не нужно писать "Верни в JSON формате..."
```

**Placeholder**:
```
Проанализируй контент из {platform}.

Статистика:
- Постов: {total_posts}
- Средняя вовлеченность: {avg_reactions} реакций

Кратко опиши:
1. Главные темы обсуждений
2. Общий настрой аудитории
3. Что выделяется
```

---

### 📝 Поле: **image_prompt** (Промпт для изображений)

**Help text**:
```html
Кастомный промпт для анализа изображений. Оставьте пустым для дефолтного.

Доступные переменные:
• {count} - количество изображений
• {platform} - название платформы

💡 JSON формат добавляется автоматически!
```

**Placeholder**:
```
Проанализируй {count} изображений из {platform}.

Опиши:
1. Визуальные темы и стиль
2. Доминирующие цвета
3. Общее настроение
```

---

### 📝 Поле: **video_prompt** (Промпт для видео)

**Help text**:
```html
Кастомный промпт для анализа видео. Оставьте пустым для дефолтного.

Доступные переменные:
• {count} - количество видео
• {platform} - название платформы

💡 JSON формат добавляется автоматически!
```

**Placeholder**:
```
Проанализируй {count} видео из {platform}.

Опиши:
1. Типы контента (короткие/длинные, stories/reels)
2. Главные темы
3. Стиль подачи
```

---

### 📝 Поле: **audio_prompt** (Промпт для аудио)

**Help text**:
```html
Кастомный промпт для анализа аудио. Оставьте пустым для дефолтного.

Доступные переменные:
• {count} - количество аудио
• {platform} - название платформы

💡 JSON формат добавляется автоматически!
```

**Placeholder**:
```
Проанализируй {count} аудио из {platform}.

Опиши:
1. Типы контента
2. Темы обсуждений
3. Стиль и настроение
```

---

### 📝 Поле: **unified_summary_prompt** (Общее резюме)

**Help text**:
```html
Кастомный промпт для создания общего резюме. Оставьте пустым для дефолтного.

Доступные переменные:
• {text_analysis} - результаты текстового анализа (JSON)
• {image_analysis} - результаты анализа изображений (JSON)
• {video_analysis} - результаты анализа видео (JSON)

💡 Используется когда есть контент разных типов (текст + изображения + видео)
```

**Placeholder**:
```
Создай общее резюме на основе:
- Текстового анализа: {text_analysis}
- Анализа изображений: {image_analysis}
- Анализа видео: {video_analysis}

Создай единое описание контента
```

---

## Технические детали

### Файл: `app/admin/views.py`

#### 1. Добавлены placeholder для промпт-полей:

```python
form_widget_args = {
    "text_prompt": {
        "rows": 10,
        "placeholder": "Проанализируй контент из {platform}.\n\n..."
    },
    "image_prompt": {
        "rows": 10,
        "placeholder": "Проанализируй {count} изображений из {platform}.\n\n..."
    },
    # ... и т.д.
}
```

#### 2. Добавлены подробные help_text:

```python
form_args = {
    'text_prompt': {
        'description': '''<b>Кастомный промпт для анализа текста.</b>
<br><br><b>Доступные переменные:</b>
<ul>
<li><code>{text}</code> - собранный текстовый контент</li>
<li><code>{platform}</code> - название платформы</li>
...
</ul>
<br><b>💡 JSON формат добавляется автоматически!</b>'''
    },
    # ... и т.д.
}
```

---

## Визуальное представление

### До изменений:

```
┌─────────────────────────────────────────┐
│ Text Prompt                             │
│ ┌─────────────────────────────────────┐ │
│ │                                     │ │
│ │  [Пустое поле без подсказок]        │ │
│ │                                     │ │
│ └─────────────────────────────────────┘ │
│ Help: Кастомный промпт для анализа...   │
└─────────────────────────────────────────┘
```

### После изменений:

```
┌─────────────────────────────────────────────────────────────┐
│ Text Prompt                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ Проанализируй контент из {platform}.                    │ │
│ │                                                         │ │
│ │ Статистика:                                             │ │
│ │ - Постов: {total_posts}                                 │ │
│ │ - Средняя вовлеченность: {avg_reactions} реакций        │ │
│ │                                                         │ │
│ │ Кратко опиши:                                           │ │
│ │ 1. Главные темы обсуждений                              │ │
│ │ 2. Общий настрой аудитории                              │ │
│ │ 3. Что выделяется                                       │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ Help: Кастомный промпт для анализа текста. Оставьте пустым │
│       для дефолтного.                                       │
│                                                             │
│       Доступные переменные:                                 │
│       • {text} - собранный текстовый контент               │
│       • {platform} - название платформы                    │
│       • {source_type} - тип источника                      │
│       • {total_posts} - количество постов                  │
│       • {avg_reactions} - среднее количество реакций       │
│       • {avg_comments} - среднее количество комментариев   │
│       • {date_from} - начало периода анализа               │
│       • {date_to} - конец периода анализа                  │
│                                                             │
│       💡 JSON формат добавляется автоматически!            │
└─────────────────────────────────────────────────────────────┘
```

---

## Преимущества

### ✅ Для пользователей:

1. **Понятнее** - сразу видно какие переменные доступны
2. **Быстрее** - можно скопировать placeholder и адаптировать
3. **Меньше ошибок** - понятно какой формат ожидается
4. **Обучение** - примеры показывают best practices

### ✅ Для системы:

1. **Качество промптов** - пользователи пишут лучшие промпты
2. **Меньше поддержки** - меньше вопросов "как использовать?"
3. **Консистентность** - все промпты следуют одному стилю

---

## Как проверить

### 1. Откройте админ-панель:
```
http://0.0.0.0:8000/admin/bot-scenarios
```

### 2. Нажмите "Создать":
```
http://0.0.0.0:8000/admin/bot-scenarios/create
```

### 3. Обратите внимание:

- ✅ Все поля имеют подробные help text под полем ввода
- ✅ Промпт-поля имеют placeholder с примерами
- ✅ HTML форматирование работает (жирный текст, списки)
- ✅ Код-блоки `{variable}` выделены моноширинным шрифтом
- ✅ Эмодзи 💡 отображается

### 4. Наведите на поле и прочитайте описание

### 5. Начните вводить текст - placeholder исчезнет

---

## Дополнительные улучшения (будущее)

### Планы:

- [ ] Добавить интерактивную валидацию переменных
- [ ] Подсветка синтаксиса переменных в редакторе
- [ ] Автодополнение переменных при вводе {
- [ ] Предпросмотр промпта с подставленными значениями
- [ ] Библиотека готовых промптов для разных задач
- [ ] Тестирование промпта прямо в админке

---

## FAQ

### Q: Как использовать переменные?

**A**: Просто напишите `{имя_переменной}` в промпте. Например:
```
Проанализируй {total_posts} постов из {platform}
```

Система автоматически подставит реальные значения при выполнении.

### Q: Что если я не хочу использовать переменные?

**A**: Можете писать статичный текст без переменных. Это тоже работает.

### Q: Placeholder перезаписывает мой текст?

**A**: Нет! Placeholder - это подсказка которая показывается только когда поле пустое. Как только начнете вводить - placeholder исчезнет.

### Q: Можно ли изменить placeholder?

**A**: Да, это настраивается в `app/admin/views.py` в `form_widget_args`.

### Q: HTML в help_text безопасен?

**A**: Да, используется только базовый безопасный HTML для форматирования (теги `<b>`, `<code>`, `<ul>`, `<li>`, `<br>`).

---

## Changelog

### v3.0-admin-ux (16.10.2025)

**Добавлено**:
- ✅ Placeholder для 5 промпт-полей (text, image, video, audio, unified_summary)
- ✅ Подробные help_text для 11 полей (name, description, content_types, analysis_types, scope, collection_interval_hours, + все промпты)
- ✅ HTML форматирование описаний (списки, жирный текст, код)
- ✅ Эмодзи в подсказках для важных моментов
- ✅ Описание всех доступных переменных
- ✅ Примеры использования в placeholder

**Изменено**:
- `form_widget_args` - добавлены placeholder
- `form_args` - расширены description

**Файлы**:
- `app/admin/views.py` (+80 строк)

---

**Автор**: Factory Droid  
**Дата создания**: 16.10.2025  
**Последнее обновление**: 16.10.2025
