{% extends "sqladmin/layout.html" %}
{% from 'sqladmin/_macros.html' import render_form_fields %}

{% block content %}
<div class="col-12">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                {% if form_type == 'create' %}Новый{% else %}Редактировать{% endif %} {{ model_view.name }}
            </h3>
        </div>
        <div class="card-body border-bottom py-3">
            <form action="
                {% if form_type == 'create' %}{{ url_for('admin:create', identity=model_view.identity) }}{% else %}{{ model_view._build_url_for('admin:edit', request, obj) }}{% endif %}"
                  method="POST"
                  enctype="multipart/form-data"
                  id="main-form">
                <div class="row">
                    {% if error %}
                        <div class="alert alert-danger" role="alert">{{ error }}</div>
                    {% endif %}
                </div>
                
                {% block form_content %}
                <fieldset class="form-fieldset">
                    {{ render_form_fields(form, form_opts=form_opts) }}
                </fieldset>
                {% endblock %}
                
                <div class="row mt-4">
                    <div class="col-md-2">
                        <a href="{{ url_for('admin:list', identity=model_view.identity) }}" class="btn">
                            Отмена
                        </a>
                    </div>
                    <div class="col-md-6">
                        <div class="btn-group flex-wrap" data-toggle="buttons">
                            <input type="submit" name="save" value="Save" class="btn">
                            <input type="submit" name="save" value="Save and continue editing" class="btn">
                            {% if model_view.can_create %}
                                {% if model_view.save_as %}
                                    <input type="submit" name="save" value="Save as new" class="btn">
                                {% else %}
                                    <input type="submit" name="save" value="Save and add another" class="btn">
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
{% endblock %}
